---

- name: detect available php version
  php_version:
    package_version: "{{ php_redhat_version }}"
  register: detected_php_version

- name: ''
  debug:
    msg: "{{ detected_php_version }}"

- name: "set php_version '{{ detected_php_version.available.version }}'"
  set_fact:
    php_version: "{{ detected_php_version.available.version }}"
    php_package_version: "{{ detected_php_version.available.package_version }}"
    php_major_version: "{{ detected_php_version.available.major_version }}"
  when:
    - not detected_php_version.failed
    - detected_php_version.available is defined
    - detected_php_version.available.version is defined
    - detected_php_version.available.package_version is defined
    - detected_php_version.available.major_version is defined

- name: do facts module to get latest information
  setup:

- name: include OS-specific variables.
  include_vars: main.yml

...
